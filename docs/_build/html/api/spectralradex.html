

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Spectral Modelling Functions &mdash; SpectralRadex 0.1.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Radex Wrapper Functions" href="radex.html" />
    <link rel="prev" title="Referencing" href="../user/referencing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> SpectralRadex
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/formalism.html">Formalism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/referencing.html">Referencing</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Spectral Modelling Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="radex.html">Radex Wrapper Functions</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/radex.html">Radex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/spectralmodelling.html">Spectral Modelling</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SpectralRadex</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Spectral Modelling Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/spectralradex.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-spectralradex">
<span id="spectral-modelling-functions"></span><span id="spectralradex"></span><h1>Spectral Modelling Functions<a class="headerlink" href="#module-spectralradex" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="spectralradex.get_tau_distribution">
<code class="sig-prename descclassname">spectralradex.</code><code class="sig-name descname">get_tau_distribution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">v0</span></em>, <em class="sig-param"><span class="n">delta_v</span></em>, <em class="sig-param"><span class="n">frequencies</span></em>, <em class="sig-param"><span class="n">tau_profile</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.get_tau_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal function meant to turn radex output into frequency
dependent optical depth and radiation temperature</p>
</dd></dl>

<dl class="py function">
<dt id="spectralradex.maxwellian_distribution">
<code class="sig-prename descclassname">spectralradex.</code><code class="sig-name descname">maxwellian_distribution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v0</span></em>, <em class="sig-param"><span class="n">delta_v</span></em>, <em class="sig-param"><span class="n">tau_0</span></em>, <em class="sig-param"><span class="n">velocities</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.maxwellian_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the optical depth as a function of velocity, assuming gaussian line profiles and given an optical depth a line centre</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v0</strong> (<em>float</em>) – Peak velocity of the emission</p></li>
<li><p><strong>delta_v</strong> – FWHM of the peaks, taken from linewidth parameter of RADEX when called via <a class="reference internal" href="#spectralradex.model_spectrum" title="spectralradex.model_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">model_spectrum()</span></code></a></p></li>
<li><p><strong>tau_0</strong> – The optical depth at line centre. Taken from RADEX when called via <a class="reference internal" href="#spectralradex.model_spectrum" title="spectralradex.model_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">model_spectrum()</span></code></a></p></li>
</ul>
</dd>
</dl>
<p>:type tau_0:float</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>velocities</strong> – An iterable containing the velocity values at which to calculate tau</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array with the tau value at each velocity in velocities</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray,float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spectralradex.model_spectrum">
<code class="sig-prename descclassname">spectralradex.</code><code class="sig-name descname">model_spectrum</code><span class="sig-paren">(</span><em class="sig-param">obs_freqs</em>, <em class="sig-param">v0</em>, <em class="sig-param">radex_params</em>, <em class="sig-param">tau_profile=&lt;function maxwellian_distribution&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.model_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the brightness temperature as a function of frequency for given input frequencies, <span class="math notranslate nohighlight">\(V_{LSR}\)</span>
velocity and RADEX parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_freqs</strong> (<em>iterable</em><em>, </em><em>float</em>) – An array of frequency values in GHz at which the brightness temperature should be calculated.</p></li>
<li><p><strong>v0</strong> (<em>float</em>) – The <span class="math notranslate nohighlight">\(V_{LSR}\)</span> velocity of the emitting object to be modelled in km/s</p></li>
<li><p><strong>radex_params</strong> (<em>dict</em>) – A dictionary containing the inputs for the RADEX model. See <a class="reference internal" href="radex.html#spectralradex.radex.get_default_parameters" title="spectralradex.radex.get_default_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">radex.get_default_parameters()</span></code></a> for a list of possible parameters. Note this includes the linewidth in km/s that will be used to set the shape of the emission lines.</p></li>
<li><p><strong>tau_profile</strong> (<em>function</em><em>, </em><em>optional</em>) – A function with the same arguments as <a class="reference internal" href="#spectralradex.maxwellian_distribution" title="spectralradex.maxwellian_distribution"><code class="xref py py-func docutils literal notranslate"><span class="pre">maxwellian_distribution()</span></code></a> that returns the optical depth as a function of velocity. If not set, spectralradex will assume gaussian line profiles centred on <a href="#id1"><span class="problematic" id="id2">:param:`v0`</span></a> and a FWHM taken from the RADEX parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spectralradex.noise_from_spectrum">
<code class="sig-prename descclassname">spectralradex.</code><code class="sig-name descname">noise_from_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">intensities</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.noise_from_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Estimate the rms noise level from a spectrum by assuming it is a gaussian noise distribution plus positive signal.</dt><dd><p>If this is true, the median should be the peak of the noise distribution and values smaller are just noise. Thus, the mean
square difference between the median and smaller values is the square of the noise rms.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>intensities</strong> (<em>float</em><em>, </em><em>iterable</em>) – An array of the intensity values representing a spectrm</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The rms noise value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spectralradex.rad_temp">
<code class="sig-prename descclassname">spectralradex.</code><code class="sig-name descname">rad_temp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">frequencies</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.rad_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate radiation temperature for a given excitation temperature
:meta private:</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="radex.html" class="btn btn-neutral float-right" title="Radex Wrapper Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../user/referencing.html" class="btn btn-neutral float-left" title="Referencing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Jonathan Holdship

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>